<% related_nav_helper = GovukPublishingComponents::Presenters::RelatedNavigationHelper.new(local_assigns) %>
<% related_content = related_nav_helper.related_navigation %>
<% if related_content.map(&:values).flatten.any? || related_nav_helper.other.flatten.any? %>
<% random = SecureRandom.hex(4) %>
  <div class="gem-c-related-navigation">
    <h2 id="related-nav-related_items-<%= random %>"
        class="gem-c-related-navigation__main-heading"
        data-track-count="sidebarRelatedItemSection" >
      <%= t('components.related_navigation.related_content') %>
    </h2>

    <% section_index = 0 %>

    <% related_content.each do |section| %>
      <% section.each do |section_title, links| %>
        <% if links.any? %>
          <% section_index += 1 %>
          <%= render 'govuk_publishing_components/components/related_navigation/section',
            related_nav_helper: related_nav_helper,
            section_title: section_title,
            links: links,
            section_index: section_index,
            random: random %>
        <% end %>
      <% end %>
    <% end %>
  </div>
<% end %>
