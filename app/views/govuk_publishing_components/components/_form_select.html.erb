<%
  form_group_helper = GovukPublishingComponents::Presenters::FormGroupHelper.new(local_assigns)

  select = select&.dup || {}
  options = select.delete(:options) || []
  select_helper = GovukPublishingComponents::Presenters::SelectHelper.new(options)

  name = select.delete(:name)
  full_width = select.delete(:full_width)

  select[:id] ||= form_group_helper.generate_field_id(name)
  select[:class] = %w(govuk-select)
  select[:class].append(*form_group_helper.additional_field_classes(select))
  select[:class] << "gem-c-form-select__select--full-width" if full_width

  select[:data] ||= {}
  if select_helper.data_tracking? && !select.dig(:data, :module).present?
    select[:data][:module] = "track-select-change"
  end
%>
<%= content_tag :div, class: "gem-c-form-select" do %>
  <%= render "govuk_publishing_components/components/form_group",
    form_group_helper.form_group_options.merge({ for_id: select[:id] }) do |field| %>
  <%
    select[:class] << "govuk-input--error" if field[:has_error]
    form_group_helper.merge_described_by(select, field[:describedby].values)
    select[:class] << "govuk-select--error" if field[:has_error] || field_error
  %>
  <%= select_tag name,
                 options_for_select(select_helper.option_markup, select_helper.selected_option),
                 select %>
  <% end %>
<% end %>
