<%
  disable_form_submit_check ||= false
  autocomplete ||= nil

  form_group_helper = GovukPublishingComponents::Presenters::FormGroupHelper.new(local_assigns)

  input = input&.dup || {}
  name = input.delete(:name)
  value = input.delete(:value)

  input[:id] ||= form_group_helper.generate_field_id(name)
  input[:type] = "password"
  input[:autocomplete] = "off" unless %w[new-password current-password].include?(autocomplete)
  input[:class] = %w(govuk-input gem-c-form-show-password__input)
%>
<%= tag.div class: "gem-c-form-show-password",
  data: {
    module: "show-password",
    disable_form_submit_check: disable_form_submit_check,
    show_text: t('components.show_password.show'),
    hide_text: t('components.show_password.hide'),
    show_full_text: t('components.show_password.show_password'),
    hide_full_text: t('components.show_password.hide_password'),
    announce_show: t('components.show_password.announce_show'),
    announce_hide: t('components.show_password.announce_hide')
  } do %>

  <%= render "govuk_publishing_components/components/form_group",
    form_group_helper.form_group_options.merge({ for_id: input[:id] }) do |field| %>
    <%
      input[:class] << "govuk-input--error" if field[:has_error]
      form_group_helper.merge_described_by(input, field[:describedby].values)
    %>
    <%= text_field_tag name, value, input %>
  <% end %>
<% end %>
