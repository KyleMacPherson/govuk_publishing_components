<%
  index ||= false
  id ||= "checkbox-#{SecureRandom.hex(4)}"
  id = "#{id}-#{index}" if index
  controls ||= item[:conditional].present? ? "#{id}-conditional-#{index || rand(1..100)}" : nil
  name = item[:name].present? ? item[:name] : name
  margin_bottom ||= false
  margin_bottom_class = "gem-c-checkbox--margin-bottom" if margin_bottom
%>

<%= tag.div class: "gem-c-checkbox govuk-checkboxes__item #{margin_bottom_class}", data: { module: "checkbox", 'aria-controls': controls }  do %>
  <%= tag.input id: id,
    name: name,
    type: "checkbox",
    value: item[:value],
    class: "govuk-checkboxes__input",
    checked: item[:checked].present? ? "checked" : nil,
    data: item[:data_attributes],
    aria: {
      describedby: item[:hint].present? ? "#{id}-item-hint" : nil
    }
  %>
  <%= tag.label item[:label], class: "govuk-label govuk-checkboxes__label", for: id %>
  <% if item[:hint].present? %>
    <%= tag.span item[:hint], id: "#{id}-item-hint", class: "govuk-hint govuk-checkboxes__hint" %>
  <% end %>
<% end %>
